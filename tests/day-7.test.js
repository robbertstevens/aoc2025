import {expect, test} from "vitest";
import {calculateSplits, parseManifold, quantumTachyon} from "../src/day-7/tachyon";

const inputTxt = `.......S.......
...............
.......^.......
...............
......^.^......
...............
.....^.^.^.....
...............
....^.^...^....
...............
...^.^...^.^...
...............
..^...^.....^..
...............
.^.^.^.^.^...^.
...............`

test("parse", () => {
    expect(parseManifold(inputTxt)).toStrictEqual([
        [".", ".", ".", ".", ".", ".", ".", "S", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", "^", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", "^", ".", "^", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", "^", ".", "^", ".", "^", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", ".", "^", ".", "^", ".", ".", ".", "^", ".", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", ".", "^", ".", "^", ".", ".", ".", "^", ".", "^", ".", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", ".", "^", ".", ".", ".", "^", ".", ".", ".", ".", ".", "^", ".", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
        [".", "^", ".", "^", ".", "^", ".", "^", ".", "^", ".", ".", ".", "^", ".",],
        [".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".", ".",],
    ])
})

test("shoot beam and calculate splits", () => {
    const [count, manifold] = calculateSplits(inputTxt);
    expect(count).toBe(21)
    expect(manifold).toBe(`.......S.......
.......|.......
......|^|......
......|.|......
.....|^|^|.....
.....|.|.|.....
....|^|^|^|....
....|.|.|.|....
...|^|^|||^|...
...|.|.|||.|...
..|^|^|||^|^|..
..|.|.|||.|.|..
.|^|||^||.||^|.
.|.|||.||.||.|.
|^|^|^|^|^|||^|
|.|.|.|.|.|||.|`)
})

test("quantum", () => {
    const result = quantumTachyon(inputTxt)
    expect(result).toBe(40)
})